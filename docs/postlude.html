<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Postlude: models and data | Notes on Statistical Thinking from Scratch</title>
  <meta name="description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Postlude: models and data | Notes on Statistical Thinking from Scratch" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  <meta name="github-repo" content="elahi/stats_from_scratch_edge" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Postlude: models and data | Notes on Statistical Thinking from Scratch" />
  
  <meta name="twitter:description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  

<meta name="author" content="Robin Elahi" />


<meta name="date" content="2020-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121894527-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121894527-4');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Statistical Thinking from Scratch</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="r-eda.html"><a href="r-eda.html"><i class="fa fa-check"></i><b>2</b> R and exploratory data analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="r-eda.html"><a href="r-eda.html#inspecting-the-dataframe"><i class="fa fa-check"></i><b>2.1</b> Inspecting the dataframe</a></li>
<li class="chapter" data-level="2.2" data-path="r-eda.html"><a href="r-eda.html#histograms"><i class="fa fa-check"></i><b>2.2</b> Histograms</a></li>
<li class="chapter" data-level="2.3" data-path="r-eda.html"><a href="r-eda.html#summarising-data"><i class="fa fa-check"></i><b>2.3</b> Summarising data</a></li>
<li class="chapter" data-level="2.4" data-path="r-eda.html"><a href="r-eda.html#loops"><i class="fa fa-check"></i><b>2.4</b> Loops</a></li>
<li class="chapter" data-level="2.5" data-path="r-eda.html"><a href="r-eda.html#functions"><i class="fa fa-check"></i><b>2.5</b> Functions</a></li>
<li class="chapter" data-level="2.6" data-path="r-eda.html"><a href="r-eda.html#boxplots"><i class="fa fa-check"></i><b>2.6</b> Boxplots</a></li>
<li class="chapter" data-level="2.7" data-path="r-eda.html"><a href="r-eda.html#scatterplots"><i class="fa fa-check"></i><b>2.7</b> Scatterplots</a></li>
<li class="chapter" data-level="2.8" data-path="r-eda.html"><a href="r-eda.html#exercise-set-2-2"><i class="fa fa-check"></i><b>2.8</b> Exercise set 2-2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="best-fit-line.html"><a href="best-fit-line.html"><i class="fa fa-check"></i><b>3</b> Line of best fit</a><ul>
<li class="chapter" data-level="3.1" data-path="best-fit-line.html"><a href="best-fit-line.html#exercise-set-3-1"><i class="fa fa-check"></i><b>3.1</b> Exercise set 3-1</a></li>
<li class="chapter" data-level="3.2" data-path="best-fit-line.html"><a href="best-fit-line.html#exercise-set-3-2"><i class="fa fa-check"></i><b>3.2</b> Exercise set 3-2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability and random variables</a><ul>
<li class="chapter" data-level="4.0.1" data-path="probability.html"><a href="probability.html#probability-vs-estimation"><i class="fa fa-check"></i><b>4.0.1</b> Probability vs estimation</a></li>
<li class="chapter" data-level="4.0.2" data-path="probability.html"><a href="probability.html#what-is-a-probability"><i class="fa fa-check"></i><b>4.0.2</b> What is a probability?</a></li>
<li class="chapter" data-level="4.0.3" data-path="probability.html"><a href="probability.html#set-notation"><i class="fa fa-check"></i><b>4.0.3</b> Set notation</a></li>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#kolmogorovs-three-axioms-of-probability"><i class="fa fa-check"></i><b>4.1</b> Kolmogorov’s three axioms of probability</a><ul>
<li class="chapter" data-level="4.1.1" data-path="probability.html"><a href="probability.html#exercise-set-4-1"><i class="fa fa-check"></i><b>4.1.1</b> Exercise set 4-1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#conditional-probability-and-independence"><i class="fa fa-check"></i><b>4.2</b> Conditional probability and independence</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#exercise-set-4-2"><i class="fa fa-check"></i><b>4.2.1</b> Exercise set 4-2</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#bayes-theorem"><i class="fa fa-check"></i><b>4.3</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#discrete-random-variables-and-distributions"><i class="fa fa-check"></i><b>4.4</b> Discrete random variables and distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="probability.html"><a href="probability.html#exercise-set-4-3"><i class="fa fa-check"></i><b>4.4.1</b> Exercise set 4-3</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#continuous-random-variables-and-distributions"><i class="fa fa-check"></i><b>4.5</b> Continuous random variables and distributions</a><ul>
<li class="chapter" data-level="4.5.1" data-path="probability.html"><a href="probability.html#exercise-set-4-4"><i class="fa fa-check"></i><b>4.5.1</b> Exercise set 4-4</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="probability.html"><a href="probability.html#probability-density-functions"><i class="fa fa-check"></i><b>4.6</b> Probability density functions</a><ul>
<li class="chapter" data-level="4.6.1" data-path="probability.html"><a href="probability.html#additional-viz"><i class="fa fa-check"></i><b>4.6.1</b> Additional viz</a></li>
<li class="chapter" data-level="4.6.2" data-path="probability.html"><a href="probability.html#exercise-set-4-5"><i class="fa fa-check"></i><b>4.6.2</b> Exercise set 4-5</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="probability.html"><a href="probability.html#families-of-distributions"><i class="fa fa-check"></i><b>4.7</b> Families of distributions</a><ul>
<li class="chapter" data-level="4.7.1" data-path="probability.html"><a href="probability.html#exercise-set-4-6"><i class="fa fa-check"></i><b>4.7.1</b> Exercise set 4-6</a></li>
<li class="chapter" data-level="4.7.2" data-path="probability.html"><a href="probability.html#additional-exercise"><i class="fa fa-check"></i><b>4.7.2</b> Additional exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="randomvars.html"><a href="randomvars.html"><i class="fa fa-check"></i><b>5</b> Properties of random variables</a><ul>
<li class="chapter" data-level="5.1" data-path="randomvars.html"><a href="randomvars.html#expected-values-and-the-law-of-large-numbers"><i class="fa fa-check"></i><b>5.1</b> Expected values and the law of large numbers</a><ul>
<li class="chapter" data-level="5.1.1" data-path="randomvars.html"><a href="randomvars.html#weak-law-of-large-numbers"><i class="fa fa-check"></i><b>5.1.1</b> Weak law of large numbers</a></li>
<li class="chapter" data-level="5.1.2" data-path="randomvars.html"><a href="randomvars.html#handy-facts-about-expectations"><i class="fa fa-check"></i><b>5.1.2</b> Handy facts about expectations</a></li>
<li class="chapter" data-level="5.1.3" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-1"><i class="fa fa-check"></i><b>5.1.3</b> Exercise set 5-1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="randomvars.html"><a href="randomvars.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.2</b> Variance and standard deviation</a><ul>
<li class="chapter" data-level="5.2.1" data-path="randomvars.html"><a href="randomvars.html#beautiful-properties-of-the-variance"><i class="fa fa-check"></i><b>5.2.1</b> Beautiful properties of the variance</a></li>
<li class="chapter" data-level="5.2.2" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-2"><i class="fa fa-check"></i><b>5.2.2</b> Exercise set 5-2</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="randomvars.html"><a href="randomvars.html#joint-distributions-covariance-and-correlation"><i class="fa fa-check"></i><b>5.3</b> Joint distributions, covariance, and correlation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="randomvars.html"><a href="randomvars.html#joint-probability-distributions"><i class="fa fa-check"></i><b>5.3.1</b> Joint probability distributions</a></li>
<li class="chapter" data-level="5.3.2" data-path="randomvars.html"><a href="randomvars.html#marginal-distributions"><i class="fa fa-check"></i><b>5.3.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="5.3.3" data-path="randomvars.html"><a href="randomvars.html#covariance"><i class="fa fa-check"></i><b>5.3.3</b> Covariance</a></li>
<li class="chapter" data-level="5.3.4" data-path="randomvars.html"><a href="randomvars.html#correlation"><i class="fa fa-check"></i><b>5.3.4</b> Correlation</a></li>
<li class="chapter" data-level="5.3.5" data-path="randomvars.html"><a href="randomvars.html#additional-exercise-1"><i class="fa fa-check"></i><b>5.3.5</b> Additional exercise</a></li>
<li class="chapter" data-level="5.3.6" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-3"><i class="fa fa-check"></i><b>5.3.6</b> Exercise set 5-3</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="randomvars.html"><a href="randomvars.html#conditional-distribution-expectation-variance"><i class="fa fa-check"></i><b>5.4</b> Conditional distribution, expectation, variance</a></li>
<li class="chapter" data-level="5.5" data-path="randomvars.html"><a href="randomvars.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> The central limit theorem</a><ul>
<li class="chapter" data-level="5.5.1" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-4"><i class="fa fa-check"></i><b>5.5.1</b> Exercise set 5-4</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="randomvars.html"><a href="randomvars.html#a-probabilistic-model-for-simple-linear-regression"><i class="fa fa-check"></i><b>5.6</b> A probabilistic model for simple linear regression</a><ul>
<li class="chapter" data-level="5.6.1" data-path="randomvars.html"><a href="randomvars.html#assumptions-of-the-linear-model"><i class="fa fa-check"></i><b>5.6.1</b> Assumptions of the linear model</a></li>
<li class="chapter" data-level="5.6.2" data-path="randomvars.html"><a href="randomvars.html#important-claims-that-follow-from-these-assumptions"><i class="fa fa-check"></i><b>5.6.2</b> Important claims that follow from these assumptions</a></li>
<li class="chapter" data-level="5.6.3" data-path="randomvars.html"><a href="randomvars.html#checking-these-assumptions"><i class="fa fa-check"></i><b>5.6.3</b> Checking these assumptions</a></li>
<li class="chapter" data-level="5.6.4" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-5"><i class="fa fa-check"></i><b>5.6.4</b> Exercise set 5-5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimators.html"><a href="estimators.html"><i class="fa fa-check"></i><b>6</b> Properties of point estimators</a><ul>
<li class="chapter" data-level="6.1" data-path="estimators.html"><a href="estimators.html#bias"><i class="fa fa-check"></i><b>6.1</b> Bias</a><ul>
<li class="chapter" data-level="6.1.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-1"><i class="fa fa-check"></i><b>6.1.1</b> Exercise set 6-1</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="estimators.html"><a href="estimators.html#variance"><i class="fa fa-check"></i><b>6.2</b> Variance</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-2"><i class="fa fa-check"></i><b>6.2.1</b> Exercise set 6-2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimators.html"><a href="estimators.html#mean-squared-error"><i class="fa fa-check"></i><b>6.3</b> Mean squared error</a><ul>
<li class="chapter" data-level="6.3.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-3"><i class="fa fa-check"></i><b>6.3.1</b> Exercise set 6-3</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="estimators.html"><a href="estimators.html#consistency"><i class="fa fa-check"></i><b>6.4</b> Consistency</a><ul>
<li class="chapter" data-level="6.4.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-4"><i class="fa fa-check"></i><b>6.4.1</b> Exercise set 6-4</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="estimators.html"><a href="estimators.html#efficiency"><i class="fa fa-check"></i><b>6.5</b> Efficiency</a><ul>
<li class="chapter" data-level="6.5.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-5"><i class="fa fa-check"></i><b>6.5.1</b> Exercise set 6-5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="estimators.html"><a href="estimators.html#statistical-decision-theory-and-risk"><i class="fa fa-check"></i><b>6.6</b> Statistical decision theory and risk</a></li>
<li class="chapter" data-level="6.7" data-path="estimators.html"><a href="estimators.html#robustness"><i class="fa fa-check"></i><b>6.7</b> Robustness</a><ul>
<li class="chapter" data-level="6.7.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-8"><i class="fa fa-check"></i><b>6.7.1</b> Exercise set 6-8</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="estimators.html"><a href="estimators.html#estimators-for-simple-linear-regression"><i class="fa fa-check"></i><b>6.8</b> Estimators for simple linear regression</a><ul>
<li class="chapter" data-level="6.8.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-9"><i class="fa fa-check"></i><b>6.8.1</b> Exercise set 6-9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intervals.html"><a href="intervals.html"><i class="fa fa-check"></i><b>7</b> Interval estimation and inference</a><ul>
<li class="chapter" data-level="7.1" data-path="intervals.html"><a href="intervals.html#standard-error"><i class="fa fa-check"></i><b>7.1</b> Standard error</a><ul>
<li class="chapter" data-level="7.1.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-1"><i class="fa fa-check"></i><b>7.1.1</b> Exercise set 7-1</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intervals.html"><a href="intervals.html#confidence-intervals"><i class="fa fa-check"></i><b>7.2</b> Confidence intervals</a><ul>
<li class="chapter" data-level="7.2.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-2"><i class="fa fa-check"></i><b>7.2.1</b> Exercise set 7-2</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="intervals.html"><a href="intervals.html#frequentist-inference-i-null-hypotheses-test-statistics-and-p-values"><i class="fa fa-check"></i><b>7.3</b> Frequentist inference I: null hypotheses, test statistics, and <em>p</em> values</a><ul>
<li class="chapter" data-level="7.3.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-3"><i class="fa fa-check"></i><b>7.3.1</b> Exercise set 7-3</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intervals.html"><a href="intervals.html#frequentist-inference-ii-alternative-hypotheses-and-the-rejection-framework"><i class="fa fa-check"></i><b>7.4</b> Frequentist inference II: alternative hypotheses and the rejection framework</a><ul>
<li class="chapter" data-level="7.4.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-4"><i class="fa fa-check"></i><b>7.4.1</b> Exercise set 7-4</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intervals.html"><a href="intervals.html#connecting-hypothesis-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>7.5</b> Connecting hypothesis tests and confidence intervals</a></li>
<li class="chapter" data-level="7.6" data-path="intervals.html"><a href="intervals.html#nhst-and-the-abuse-of-tests"><i class="fa fa-check"></i><b>7.6</b> NHST and the abuse of tests</a><ul>
<li class="chapter" data-level="7.6.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-5"><i class="fa fa-check"></i><b>7.6.1</b> Exercise set 7-5</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="intervals.html"><a href="intervals.html#frequentist-inference-iii-power"><i class="fa fa-check"></i><b>7.7</b> Frequentist inference III: power</a><ul>
<li class="chapter" data-level="7.7.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-6"><i class="fa fa-check"></i><b>7.7.1</b> Exercise set 7-6</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="intervals.html"><a href="intervals.html#putting-it-together-what-happens-when-the-sample-size-increases"><i class="fa fa-check"></i><b>7.8</b> Putting it together: what happens when the sample size increases?</a></li>
<li class="chapter" data-level="7.9" data-path="intervals.html"><a href="intervals.html#chapter-summary"><i class="fa fa-check"></i><b>7.9</b> Chapter summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="semiparametric.html"><a href="semiparametric.html"><i class="fa fa-check"></i><b>8</b> Semiparametric estimation and inference</a><ul>
<li class="chapter" data-level="8.0.1" data-path="semiparametric.html"><a href="semiparametric.html#exercise-set-8-1"><i class="fa fa-check"></i><b>8.0.1</b> Exercise set 8-1</a></li>
<li class="chapter" data-level="8.1" data-path="semiparametric.html"><a href="semiparametric.html#semiparametric-point-estimation-using-the-method-of-moments"><i class="fa fa-check"></i><b>8.1</b> Semiparametric point estimation using the method of moments</a><ul>
<li class="chapter" data-level="8.1.1" data-path="semiparametric.html"><a href="semiparametric.html#introduction-to-moments"><i class="fa fa-check"></i><b>8.1.1</b> Introduction to moments</a></li>
<li class="chapter" data-level="8.1.2" data-path="semiparametric.html"><a href="semiparametric.html#plug-in-estimators"><i class="fa fa-check"></i><b>8.1.2</b> Plug-in estimators</a></li>
<li class="chapter" data-level="8.1.3" data-path="semiparametric.html"><a href="semiparametric.html#exercise-set-8-2"><i class="fa fa-check"></i><b>8.1.3</b> Exercise set 8-2</a></li>
<li class="chapter" data-level="8.1.4" data-path="semiparametric.html"><a href="semiparametric.html#the-method-of-moments"><i class="fa fa-check"></i><b>8.1.4</b> The method of moments</a></li>
<li class="chapter" data-level="8.1.5" data-path="semiparametric.html"><a href="semiparametric.html#exercise-set-8-3"><i class="fa fa-check"></i><b>8.1.5</b> Exercise set 8-3</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="semiparametric.html"><a href="semiparametric.html#semiparametric-interval-estimation-using-the-bootstrap"><i class="fa fa-check"></i><b>8.2</b> Semiparametric interval estimation using the bootstrap</a><ul>
<li class="chapter" data-level="8.2.1" data-path="semiparametric.html"><a href="semiparametric.html#exercise-set-8-4"><i class="fa fa-check"></i><b>8.2.1</b> Exercise set 8-4</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="semiparametric.html"><a href="semiparametric.html#semiparametric-hypothesis-testing-using-permutation-tests"><i class="fa fa-check"></i><b>8.3</b> Semiparametric hypothesis testing using permutation tests</a><ul>
<li class="chapter" data-level="8.3.1" data-path="semiparametric.html"><a href="semiparametric.html#exercise-set-8-5"><i class="fa fa-check"></i><b>8.3.1</b> Exercise set 8-5</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="semiparametric.html"><a href="semiparametric.html#chapter-summary-1"><i class="fa fa-check"></i><b>8.4</b> Chapter summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="parametric.html"><a href="parametric.html"><i class="fa fa-check"></i><b>9</b> Parametric estimation and inference</a><ul>
<li class="chapter" data-level="9.0.1" data-path="parametric.html"><a href="parametric.html#exercise-set-9-1"><i class="fa fa-check"></i><b>9.0.1</b> Exercise set 9-1</a></li>
<li class="chapter" data-level="9.1" data-path="parametric.html"><a href="parametric.html#parametric-estimation-using-maximum-likelihood"><i class="fa fa-check"></i><b>9.1</b> Parametric estimation using maximum likelihood</a><ul>
<li class="chapter" data-level="9.1.1" data-path="parametric.html"><a href="parametric.html#exercise-set-9-2"><i class="fa fa-check"></i><b>9.1.1</b> Exercise set 9-2</a></li>
<li class="chapter" data-level="9.1.2" data-path="parametric.html"><a href="parametric.html#maximum-likelihood-estimation-for-simple-linear-regression"><i class="fa fa-check"></i><b>9.1.2</b> Maximum-likelihood estimation for simple linear regression</a></li>
<li class="chapter" data-level="9.1.3" data-path="parametric.html"><a href="parametric.html#exercise-set-9-3"><i class="fa fa-check"></i><b>9.1.3</b> Exercise set 9-3</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="parametric.html"><a href="parametric.html#parametric-interval-estimation-the-direct-approach-and-fisher-information"><i class="fa fa-check"></i><b>9.2</b> Parametric interval estimation: the direct approach and Fisher information</a><ul>
<li class="chapter" data-level="9.2.1" data-path="parametric.html"><a href="parametric.html#exercise-set-9-4"><i class="fa fa-check"></i><b>9.2.1</b> Exercise set 9-4</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="parametric.html"><a href="parametric.html#parametric-hypothesis-testing-using-the-wald-test"><i class="fa fa-check"></i><b>9.3</b> Parametric hypothesis testing using the Wald test</a><ul>
<li class="chapter" data-level="9.3.1" data-path="parametric.html"><a href="parametric.html#wald-test"><i class="fa fa-check"></i><b>9.3.1</b> Wald test</a></li>
<li class="chapter" data-level="9.3.2" data-path="parametric.html"><a href="parametric.html#exercise-set-9-5"><i class="fa fa-check"></i><b>9.3.2</b> Exercise set 9-5</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="parametric.html"><a href="parametric.html#parametric-hypothesis-testing-using-the-likelihood-ratio-test"><i class="fa fa-check"></i><b>9.4</b> Parametric hypothesis testing using the likelihood-ratio test</a><ul>
<li class="chapter" data-level="9.4.1" data-path="parametric.html"><a href="parametric.html#exercise-set-9-6"><i class="fa fa-check"></i><b>9.4.1</b> Exercise set 9-6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>10</b> Bayesian estimation and inference</a><ul>
<li class="chapter" data-level="10.1" data-path="bayesian.html"><a href="bayesian.html#how-to-choose-a-prior-distribution"><i class="fa fa-check"></i><b>10.1</b> How to choose a prior distribution?</a></li>
<li class="chapter" data-level="10.2" data-path="bayesian.html"><a href="bayesian.html#the-unscaled-posterior-conjugacy-and-sampling-from-the-posterior"><i class="fa fa-check"></i><b>10.2</b> The unscaled posterior, conjugacy, and sampling from the posterior</a><ul>
<li class="chapter" data-level="10.2.1" data-path="bayesian.html"><a href="bayesian.html#rejection-sampling-algorithm"><i class="fa fa-check"></i><b>10.2.1</b> Rejection sampling algorithm</a></li>
<li class="chapter" data-level="10.2.2" data-path="bayesian.html"><a href="bayesian.html#exercise-set-10-1"><i class="fa fa-check"></i><b>10.2.2</b> Exercise set 10-1</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="bayesian.html"><a href="bayesian.html#bayesian-point-estimation-using-bayes-estimators"><i class="fa fa-check"></i><b>10.3</b> Bayesian point estimation using Bayes estimators</a><ul>
<li class="chapter" data-level="10.3.1" data-path="bayesian.html"><a href="bayesian.html#exercise-set-10-2"><i class="fa fa-check"></i><b>10.3.1</b> Exercise set 10-2</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="bayesian.html"><a href="bayesian.html#bayesian-interval-estimation-using-credible-intervals"><i class="fa fa-check"></i><b>10.4</b> Bayesian interval estimation using credible intervals</a><ul>
<li class="chapter" data-level="10.4.1" data-path="bayesian.html"><a href="bayesian.html#exercise-set-10-3"><i class="fa fa-check"></i><b>10.4.1</b> Exercise set 10-3</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="bayesian.html"><a href="bayesian.html#bayesian-hypothesis-testing-using-bayes-factors"><i class="fa fa-check"></i><b>10.5</b> Bayesian ‘hypothesis testing’ using Bayes factors</a><ul>
<li class="chapter" data-level="10.5.1" data-path="bayesian.html"><a href="bayesian.html#exercise-set-10-4"><i class="fa fa-check"></i><b>10.5.1</b> Exercise set 10-4</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="bayesian.html"><a href="bayesian.html#conclusion-bayesian-vs.-frequentist-methods"><i class="fa fa-check"></i><b>10.6</b> Conclusion: Bayesian vs. frequentist methods</a></li>
<li class="chapter" data-level="10.7" data-path="bayesian.html"><a href="bayesian.html#chapter-summary-2"><i class="fa fa-check"></i><b>10.7</b> Chapter summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="postlude.html"><a href="postlude.html"><i class="fa fa-check"></i><b>11</b> Postlude: models and data</a><ul>
<li class="chapter" data-level="11.1" data-path="postlude.html"><a href="postlude.html#post.1-evaluating-assumptions"><i class="fa fa-check"></i><b>11.1</b> Post.1 Evaluating assumptions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="postlude.html"><a href="postlude.html#exercise-set-postlude-1"><i class="fa fa-check"></i><b>11.1.1</b> Exercise set Postlude-1</a></li>
<li class="chapter" data-level="11.1.2" data-path="postlude.html"><a href="postlude.html#exercise-set-postlude-2"><i class="fa fa-check"></i><b>11.1.2</b> Exercise set Postlude-2</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="postlude.html"><a href="postlude.html#post.2-some-extensions-of-simple-linear-regression"><i class="fa fa-check"></i><b>11.2</b> Post.2 Some extensions of simple linear regression</a><ul>
<li class="chapter" data-level="11.2.1" data-path="postlude.html"><a href="postlude.html#multiple-regression"><i class="fa fa-check"></i><b>11.2.1</b> Multiple regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="postlude.html"><a href="postlude.html#exercise-set-postlude-3"><i class="fa fa-check"></i><b>11.2.2</b> Exercise set Postlude-3</a></li>
<li class="chapter" data-level="11.2.3" data-path="postlude.html"><a href="postlude.html#generalized-linear-models"><i class="fa fa-check"></i><b>11.2.3</b> Generalized linear models</a></li>
<li class="chapter" data-level="11.2.4" data-path="postlude.html"><a href="postlude.html#exercise-set-postlude-4"><i class="fa fa-check"></i><b>11.2.4</b> Exercise set Postlude-4</a></li>
<li class="chapter" data-level="11.2.5" data-path="postlude.html"><a href="postlude.html#mixed-models"><i class="fa fa-check"></i><b>11.2.5</b> Mixed models</a></li>
<li class="chapter" data-level="11.2.6" data-path="postlude.html"><a href="postlude.html#exercise-set-postlude-5"><i class="fa fa-check"></i><b>11.2.6</b> Exercise set Postlude-5</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="postlude.html"><a href="postlude.html#post.3-conclusion"><i class="fa fa-check"></i><b>11.3</b> Post.3 Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on Statistical Thinking from Scratch</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="postlude" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Postlude: models and data</h1>
<div id="post.1-evaluating-assumptions" class="section level2">
<h2><span class="header-section-number">11.1</span> Post.1 Evaluating assumptions</h2>
<p>Fitting the models:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="postlude.html#cb421-1"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(anscombe<span class="op">$</span>y1 <span class="op">~</span><span class="st"> </span>anscombe<span class="op">$</span>x1)</span>
<span id="cb421-2"><a href="postlude.html#cb421-2"></a>mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(anscombe<span class="op">$</span>y2 <span class="op">~</span><span class="st"> </span>anscombe<span class="op">$</span>x2)</span>
<span id="cb421-3"><a href="postlude.html#cb421-3"></a>mod3 &lt;-<span class="st"> </span><span class="kw">lm</span>(anscombe<span class="op">$</span>y3 <span class="op">~</span><span class="st"> </span>anscombe<span class="op">$</span>x3)</span>
<span id="cb421-4"><a href="postlude.html#cb421-4"></a>mod4 &lt;-<span class="st"> </span><span class="kw">lm</span>(anscombe<span class="op">$</span>y4 <span class="op">~</span><span class="st"> </span>anscombe<span class="op">$</span>x4)</span>
<span id="cb421-5"><a href="postlude.html#cb421-5"></a><span class="kw">summary</span>(mod1)</span>
<span id="cb421-6"><a href="postlude.html#cb421-6"></a><span class="kw">summary</span>(mod2)</span>
<span id="cb421-7"><a href="postlude.html#cb421-7"></a><span class="kw">summary</span>(mod3)</span>
<span id="cb421-8"><a href="postlude.html#cb421-8"></a><span class="kw">summary</span>(mod4)</span></code></pre></div>
<p>Plotting the quartet:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="postlude.html#cb422-1"></a>x &lt;-<span class="st"> </span>anscombe <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb422-2"><a href="postlude.html#cb422-2"></a><span class="st">  </span><span class="kw">select</span>(x1<span class="op">:</span>x4) <span class="op">%&gt;%</span></span>
<span id="cb422-3"><a href="postlude.html#cb422-3"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> datx, <span class="dt">value =</span> x, x1<span class="op">:</span>x4)</span>
<span id="cb422-4"><a href="postlude.html#cb422-4"></a>y &lt;-<span class="st"> </span>anscombe <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb422-5"><a href="postlude.html#cb422-5"></a><span class="st">  </span><span class="kw">select</span>(y1<span class="op">:</span>y4) <span class="op">%&gt;%</span></span>
<span id="cb422-6"><a href="postlude.html#cb422-6"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> daty, <span class="dt">value =</span> y, y1<span class="op">:</span>y4)</span>
<span id="cb422-7"><a href="postlude.html#cb422-7"></a>d &lt;-<span class="st"> </span><span class="kw">cbind</span>(x, y)</span>
<span id="cb422-8"><a href="postlude.html#cb422-8"></a></span>
<span id="cb422-9"><a href="postlude.html#cb422-9"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb422-10"><a href="postlude.html#cb422-10"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb422-11"><a href="postlude.html#cb422-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb422-12"><a href="postlude.html#cb422-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb422-13"><a href="postlude.html#cb422-13"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>datx)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div id="exercise-set-postlude-1" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Exercise set Postlude-1</h3>
<ol style="list-style-type: decimal">
<li>Plotting the assumptions from the <code>lm</code> models:</li>
</ol>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="postlude.html#cb423-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb423-2"><a href="postlude.html#cb423-2"></a><span class="kw">plot</span>(mod1)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="postlude.html#cb424-1"></a><span class="kw">plot</span>(mod2)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="postlude.html#cb425-1"></a><span class="kw">plot</span>(mod3)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="postlude.html#cb426-1"></a><span class="kw">plot</span>(mod4)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
</div>
<div id="exercise-set-postlude-2" class="section level3">
<h3><span class="header-section-number">11.1.2</span> Exercise set Postlude-2</h3>
<ol style="list-style-type: decimal">
<li>Applying <code>gvlma</code> to the <code>lm</code> models:</li>
</ol>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="postlude.html#cb427-1"></a><span class="kw">library</span>(gvlma)</span>
<span id="cb427-2"><a href="postlude.html#cb427-2"></a><span class="kw">gvlma</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = anscombe$y1 ~ anscombe$x1)
## 
## Coefficients:
## (Intercept)  anscombe$x1  
##      3.0001       0.5001  
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = mod1) 
## 
##                      Value p-value                Decision
## Global Stat        1.24763  0.8702 Assumptions acceptable.
## Skewness           0.02736  0.8686 Assumptions acceptable.
## Kurtosis           0.26208  0.6087 Assumptions acceptable.
## Link Function      0.68565  0.4076 Assumptions acceptable.
## Heteroscedasticity 0.27255  0.6016 Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="postlude.html#cb429-1"></a><span class="kw">gvlma</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = anscombe$y2 ~ anscombe$x2)
## 
## Coefficients:
## (Intercept)  anscombe$x2  
##       3.001        0.500  
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = mod2) 
## 
##                       Value   p-value                   Decision
## Global Stat        12.17209 0.0161164 Assumptions NOT satisfied!
## Skewness            0.58916 0.4427453    Assumptions acceptable.
## Kurtosis            0.51843 0.4715134    Assumptions acceptable.
## Link Function      10.99998 0.0009111 Assumptions NOT satisfied!
## Heteroscedasticity  0.06453 0.7994766    Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="postlude.html#cb431-1"></a><span class="kw">gvlma</span>(mod3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = anscombe$y3 ~ anscombe$x3)
## 
## Coefficients:
## (Intercept)  anscombe$x3  
##      3.0025       0.4997  
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = mod3) 
## 
##                      Value  p-value                   Decision
## Global Stat        16.9134 0.002009 Assumptions NOT satisfied!
## Skewness            7.6349 0.005725 Assumptions NOT satisfied!
## Kurtosis            5.8431 0.015638 Assumptions NOT satisfied!
## Link Function       0.6055 0.436470    Assumptions acceptable.
## Heteroscedasticity  2.8297 0.092533    Assumptions acceptable.</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="postlude.html#cb433-1"></a><span class="kw">gvlma</span>(mod4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = anscombe$y4 ~ anscombe$x4)
## 
## Coefficients:
## (Intercept)  anscombe$x4  
##      3.0017       0.4999  
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = mod4) 
## 
##                         Value p-value                Decision
## Global Stat         5.919e-01  0.9640 Assumptions acceptable.
## Skewness            1.724e-04  0.9895 Assumptions acceptable.
## Kurtosis            5.242e-01  0.4691 Assumptions acceptable.
## Link Function      -2.037e-16  1.0000 Assumptions acceptable.
## Heteroscedasticity  6.750e-02  0.7950 Assumptions acceptable.</code></pre>
</div>
</div>
<div id="post.2-some-extensions-of-simple-linear-regression" class="section level2">
<h2><span class="header-section-number">11.2</span> Post.2 Some extensions of simple linear regression</h2>
<div id="multiple-regression" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Multiple regression</h3>
</div>
<div id="exercise-set-postlude-3" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Exercise set Postlude-3</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>First, a multiple regression of mpg vs transmission (0 = automatic; 1 = manual)</li>
</ol>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="postlude.html#cb435-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Next, we extract the residuals after fitting two models:</li>
</ol>
<ul>
<li>transmission ~ horsepower</li>
<li>mpg ~ horsepower</li>
</ul>
<p>And then fit a model of the residuals:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="postlude.html#cb436-1"></a>resid.am.hp &lt;-<span class="st"> </span><span class="kw">lm</span>(am <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)<span class="op">$</span>residuals</span>
<span id="cb436-2"><a href="postlude.html#cb436-2"></a>resid.mpg.hp &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)<span class="op">$</span>residuals</span>
<span id="cb436-3"><a href="postlude.html#cb436-3"></a>m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(resid.mpg.hp <span class="op">~</span><span class="st"> </span>resid.am.hp)</span></code></pre></div>
<p>Now compare the coefficient for transmission type:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="postlude.html#cb437-1"></a><span class="kw">summary</span>(m1)<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>##               Estimate  Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 26.5849137 1.425094292 18.654845 1.073954e-17
## am           5.2770853 1.079540576  4.888270 3.460318e-05
## hp          -0.0588878 0.007856745 -7.495191 2.920375e-08</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="postlude.html#cb439-1"></a><span class="kw">summary</span>(m2)<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>##                  Estimate Std. Error       t value     Pr(&gt;|t|)
## (Intercept) -3.925231e-17  0.5056342 -7.762986e-17 1.000000e+00
## resid.am.hp  5.277085e+00  1.0613957  4.971836e+00 2.522476e-05</code></pre>
<p>Plot the variables:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="postlude.html#cb441-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb441-2"><a href="postlude.html#cb441-2"></a><span class="kw">plot</span>(mpg <span class="op">~</span><span class="st"> </span>am, <span class="dt">data =</span> mtcars)</span>
<span id="cb441-3"><a href="postlude.html#cb441-3"></a><span class="kw">plot</span>(mpg <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)</span>
<span id="cb441-4"><a href="postlude.html#cb441-4"></a><span class="kw">plot</span>(am <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> mtcars)</span>
<span id="cb441-5"><a href="postlude.html#cb441-5"></a><span class="kw">plot</span>(resid.mpg.hp <span class="op">~</span><span class="st"> </span>resid.am.hp)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>To get the estimated slope of horsepower using only simple linear regression:</li>
</ol>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="postlude.html#cb442-1"></a>resid.hp.am &lt;-<span class="st"> </span><span class="kw">lm</span>(hp <span class="op">~</span><span class="st"> </span>am, <span class="dt">data =</span> mtcars)<span class="op">$</span>residuals</span>
<span id="cb442-2"><a href="postlude.html#cb442-2"></a>resid.mpg.am &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>am, <span class="dt">data =</span> mtcars)<span class="op">$</span>residuals</span>
<span id="cb442-3"><a href="postlude.html#cb442-3"></a>m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(resid.mpg.am <span class="op">~</span><span class="st"> </span>resid.hp.am)</span></code></pre></div>
<p>Now compare the coefficient for transmission type:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="postlude.html#cb443-1"></a><span class="kw">summary</span>(m1)<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>##               Estimate  Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 26.5849137 1.425094292 18.654845 1.073954e-17
## am           5.2770853 1.079540576  4.888270 3.460318e-05
## hp          -0.0588878 0.007856745 -7.495191 2.920375e-08</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="postlude.html#cb445-1"></a><span class="kw">summary</span>(m3)<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>##                  Estimate  Std. Error       t value     Pr(&gt;|t|)
## (Intercept) -1.985302e-16 0.505634181 -3.926359e-16 1.000000e+00
## resid.hp.am -5.888780e-02 0.007724689 -7.623324e+00 1.676672e-08</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="postlude.html#cb447-1"></a><span class="kw">mean</span>(mtcars<span class="op">$</span>mpg) <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mtcars<span class="op">$</span>am) <span class="op">*</span><span class="st"> </span><span class="fl">5.277</span>) <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mtcars<span class="op">$</span>hp) <span class="op">*</span><span class="st"> </span><span class="fl">-0.0588</span>)</span></code></pre></div>
<pre><code>## [1] 26.57207</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Comparing <code>lm</code> with other tests</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>T-test</li>
</ol>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="postlude.html#cb449-1"></a><span class="kw">t.test</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>am, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mtcars$mpg by mtcars$am
## t = -4.1061, df = 30, p-value = 0.000285
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -10.84837  -3.64151
## sample estimates:
## mean in group 0 mean in group 1 
##        17.14737        24.39231</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="postlude.html#cb451-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>am)</span>
<span id="cb451-2"><a href="postlude.html#cb451-2"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mtcars$mpg ~ mtcars$am)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3923 -3.0923 -0.2974  3.2439  9.5077 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   17.147      1.125  15.247 1.13e-15 ***
## mtcars$am      7.245      1.764   4.106 0.000285 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.902 on 30 degrees of freedom
## Multiple R-squared:  0.3598, Adjusted R-squared:  0.3385 
## F-statistic: 16.86 on 1 and 30 DF,  p-value: 0.000285</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Correlation</li>
</ol>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="postlude.html#cb453-1"></a><span class="kw">cor.test</span>(anscombe<span class="op">$</span>x1, anscombe<span class="op">$</span>y1)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  anscombe$x1 and anscombe$y1
## t = 4.2415, df = 9, p-value = 0.00217
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4243912 0.9506933
## sample estimates:
##       cor 
## 0.8164205</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="postlude.html#cb455-1"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(anscombe<span class="op">$</span>y1 <span class="op">~</span><span class="st"> </span>anscombe<span class="op">$</span>x1)</span>
<span id="cb455-2"><a href="postlude.html#cb455-2"></a><span class="kw">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = anscombe$y1 ~ anscombe$x1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.92127 -0.45577 -0.04136  0.70941  1.83882 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.0001     1.1247   2.667  0.02573 * 
## anscombe$x1   0.5001     0.1179   4.241  0.00217 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.237 on 9 degrees of freedom
## Multiple R-squared:  0.6665, Adjusted R-squared:  0.6295 
## F-statistic: 17.99 on 1 and 9 DF,  p-value: 0.00217</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>ANOVA</li>
</ol>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="postlude.html#cb457-1"></a>anova.fit &lt;-<span class="st"> </span><span class="kw">aov</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</span>
<span id="cb457-2"><a href="postlude.html#cb457-2"></a><span class="kw">summary</span>(anova.fit)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## group        2  3.766  1.8832   4.846 0.0159 *
## Residuals   27 10.492  0.3886                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="postlude.html#cb459-1"></a>lm.fit &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</span>
<span id="cb459-2"><a href="postlude.html#cb459-2"></a><span class="kw">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
</div>
<div id="generalized-linear-models" class="section level3">
<h3><span class="header-section-number">11.2.3</span> Generalized linear models</h3>
</div>
<div id="exercise-set-postlude-4" class="section level3">
<h3><span class="header-section-number">11.2.4</span> Exercise set Postlude-4</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="postlude.html#cb461-1"></a><span class="kw">library</span>(car)</span>
<span id="cb461-2"><a href="postlude.html#cb461-2"></a>probit.fit &lt;-<span class="st"> </span><span class="kw">glm</span>(volunteer <span class="op">~</span><span class="st"> </span>extraversion <span class="op">+</span><span class="st"> </span>neuroticism <span class="op">+</span><span class="st"> </span>sex, </span>
<span id="cb461-3"><a href="postlude.html#cb461-3"></a>                  <span class="dt">data =</span> Cowles, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>))</span>
<span id="cb461-4"><a href="postlude.html#cb461-4"></a><span class="kw">summary</span>(probit.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = volunteer ~ extraversion + neuroticism + sex, family = binomial(&quot;probit&quot;), 
##     data = Cowles)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3947  -1.0468  -0.9091   1.2611   1.6901  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -0.692584   0.153670  -4.507 6.58e-06 ***
## extraversion  0.040934   0.008790   4.657 3.21e-06 ***
## neuroticism   0.004104   0.007044   0.583   0.5601    
## sexmale      -0.145677   0.068957  -2.113   0.0346 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1933.5  on 1420  degrees of freedom
## Residual deviance: 1906.1  on 1417  degrees of freedom
## AIC: 1914.1
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="postlude.html#cb463-1"></a><span class="kw">plot</span>(<span class="kw">sim.lm</span>(<span class="dv">5000</span>, <span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">het.coef =</span> <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="postlude.html#cb464-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb464-2"><a href="postlude.html#cb464-2"></a></span>
<span id="cb464-3"><a href="postlude.html#cb464-3"></a>ests &lt;-<span class="st"> </span><span class="kw">sim.lm.ests</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">nsim =</span> <span class="dv">1000</span>, <span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">het.coef =</span> <span class="fl">0.25</span>)</span>
<span id="cb464-4"><a href="postlude.html#cb464-4"></a><span class="kw">colMeans</span>(ests)</span></code></pre></div>
<pre><code>## [1] 3.048717 0.492909</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="postlude.html#cb466-1"></a><span class="kw">apply</span>(ests, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 2.33058271 0.04227503</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="postlude.html#cb468-1"></a><span class="kw">hist</span>(ests[,<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;n = 10&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Slope&quot;</span>)</span>
<span id="cb468-2"><a href="postlude.html#cb468-2"></a></span>
<span id="cb468-3"><a href="postlude.html#cb468-3"></a>ests &lt;-<span class="st"> </span><span class="kw">sim.lm.ests</span>(<span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">nsim =</span> <span class="dv">1000</span>, <span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">het.coef =</span> <span class="fl">0.25</span>)</span>
<span id="cb468-4"><a href="postlude.html#cb468-4"></a><span class="kw">colMeans</span>(ests)</span></code></pre></div>
<pre><code>## [1] 3.0191249 0.4969704</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="postlude.html#cb470-1"></a><span class="kw">apply</span>(ests, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 0.337768664 0.006242319</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="postlude.html#cb472-1"></a><span class="kw">hist</span>(ests[,<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;n = 50&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Slope&quot;</span>)</span>
<span id="cb472-2"><a href="postlude.html#cb472-2"></a></span>
<span id="cb472-3"><a href="postlude.html#cb472-3"></a>ests &lt;-<span class="st"> </span><span class="kw">sim.lm.ests</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">nsim =</span> <span class="dv">1000</span>, <span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">het.coef =</span> <span class="fl">0.25</span>)</span>
<span id="cb472-4"><a href="postlude.html#cb472-4"></a><span class="kw">colMeans</span>(ests)</span></code></pre></div>
<pre><code>## [1] 3.0044014 0.4995332</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="postlude.html#cb474-1"></a><span class="kw">apply</span>(ests, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 0.156064713 0.002956491</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="postlude.html#cb476-1"></a><span class="kw">hist</span>(ests[,<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;n = 100&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Slope&quot;</span>)</span>
<span id="cb476-2"><a href="postlude.html#cb476-2"></a></span>
<span id="cb476-3"><a href="postlude.html#cb476-3"></a>ests &lt;-<span class="st"> </span><span class="kw">sim.lm.ests</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">nsim =</span> <span class="dv">1000</span>, <span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">het.coef =</span> <span class="fl">0.25</span>)</span>
<span id="cb476-4"><a href="postlude.html#cb476-4"></a><span class="kw">colMeans</span>(ests)</span></code></pre></div>
<pre><code>## [1] 3.0013893 0.4997909</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="postlude.html#cb478-1"></a><span class="kw">apply</span>(ests, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 0.0159777401 0.0002886682</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="postlude.html#cb480-1"></a><span class="kw">hist</span>(ests[,<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;n = 1000&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Slope&quot;</span>)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
</div>
<div id="mixed-models" class="section level3">
<h3><span class="header-section-number">11.2.5</span> Mixed models</h3>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="postlude.html#cb481-1"></a><span class="kw">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb481-2"><a href="postlude.html#cb481-2"></a>alpha &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb481-3"><a href="postlude.html#cb481-3"></a>beta &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb481-4"><a href="postlude.html#cb481-4"></a>eps.sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">0.5</span>)</span>
<span id="cb481-5"><a href="postlude.html#cb481-5"></a>re.sd &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb481-6"><a href="postlude.html#cb481-6"></a>yrs &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb481-7"><a href="postlude.html#cb481-7"></a>x &lt;-<span class="st"> </span><span class="kw">rep</span>(anscombe<span class="op">$</span>x1, <span class="dv">10</span>)</span>
<span id="cb481-8"><a href="postlude.html#cb481-8"></a>rand.ints &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(anscombe<span class="op">$</span>x1), <span class="dv">0</span>, re.sd)</span>
<span id="cb481-9"><a href="postlude.html#cb481-9"></a>y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta<span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rep</span>(rand.ints, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(x), <span class="dv">0</span>, eps.sd)</span>
<span id="cb481-10"><a href="postlude.html#cb481-10"></a>d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">j =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">11</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb481-11"><a href="postlude.html#cb481-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> letters[j])</span></code></pre></div>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="postlude.html#cb482-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb482-2"><a href="postlude.html#cb482-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y, <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb482-3"><a href="postlude.html#cb482-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb482-4"><a href="postlude.html#cb482-4"></a><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb482-5"><a href="postlude.html#cb482-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Fertilizer consumption (kg/hectare)&quot;</span>, </span>
<span id="cb482-6"><a href="postlude.html#cb482-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Cereal yield (100 kg/hectare)&quot;</span>)</span></code></pre></div>
<p><img src="11_postlude_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Here’s the linear model:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="postlude.html#cb483-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> d)</span>
<span id="cb483-2"><a href="postlude.html#cb483-2"></a><span class="kw">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.56402 -0.84873  0.05249  0.81626  2.49028 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.11366    0.34591   9.001 8.63e-15 ***
## x            0.52696    0.03626  14.532  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.203 on 108 degrees of freedom
## Multiple R-squared:  0.6616, Adjusted R-squared:  0.6585 
## F-statistic: 211.2 on 1 and 108 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Here’s a mixed-effects model fit using <code>lmer</code>:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="postlude.html#cb485-1"></a><span class="kw">library</span>(lme4)</span>
<span id="cb485-2"><a href="postlude.html#cb485-2"></a>mm1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group), <span class="dt">data =</span> d, <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span>
<span id="cb485-3"><a href="postlude.html#cb485-3"></a><span class="kw">summary</span>(mm1)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ x + (1 | group)
##    Data: d
## 
## REML criterion at convergence: 358
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.13200 -0.70572  0.04365  0.67872  2.07068 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  group    (Intercept) 0.000    0.000   
##  Residual             1.446    1.203   
## Number of obs: 110, groups:  group, 10
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  3.11366    0.34591   9.001
## x            0.52696    0.03626  14.532
## 
## Correlation of Fixed Effects:
##   (Intr)
## x -0.943</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="postlude.html#cb487-1"></a><span class="kw">library</span>(nlme)</span>
<span id="cb487-2"><a href="postlude.html#cb487-2"></a>mm2 &lt;-<span class="st"> </span><span class="kw">lme</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group, <span class="dt">data =</span> d)</span>
<span id="cb487-3"><a href="postlude.html#cb487-3"></a><span class="kw">summary</span>(mm2)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##  Data: d 
##        AIC      BIC    logLik
##   366.0498 376.7783 -179.0249
## 
## Random effects:
##  Formula: ~1 | group
##          (Intercept) Residual
## StdDev: 3.182308e-05 1.202637
## 
## Fixed effects: y ~ x 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 3.1136600 0.3459065 99  9.001449       0
## x           0.5269571 0.0362609 99 14.532394       0
##  Correlation: 
##   (Intr)
## x -0.943
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -2.13200120 -0.70572491  0.04364566  0.67872464  2.07068222 
## 
## Number of Observations: 110
## Number of Groups: 10</code></pre>
</div>
<div id="exercise-set-postlude-5" class="section level3">
<h3><span class="header-section-number">11.2.6</span> Exercise set Postlude-5</h3>
</div>
</div>
<div id="post.3-conclusion" class="section level2">
<h2><span class="header-section-number">11.3</span> Post.3 Conclusion</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
