<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Interval estimation and inference | Notes on Statistical Thinking from Scratch</title>
  <meta name="description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Interval estimation and inference | Notes on Statistical Thinking from Scratch" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  <meta name="github-repo" content="elahi/stats_from_scratch_edge" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Interval estimation and inference | Notes on Statistical Thinking from Scratch" />
  
  <meta name="twitter:description" content="Cliff notes for Statistical Thinking from Scratch, by Doc Edge." />
  

<meta name="author" content="Robin Elahi" />


<meta name="date" content="2020-07-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimators.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121894527-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121894527-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Statistical Thinking from Scratch</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="r-eda.html"><a href="r-eda.html"><i class="fa fa-check"></i><b>2</b> R and exploratory data analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="r-eda.html"><a href="r-eda.html#inspecting-the-dataframe"><i class="fa fa-check"></i><b>2.1</b> Inspecting the dataframe</a></li>
<li class="chapter" data-level="2.2" data-path="r-eda.html"><a href="r-eda.html#histograms"><i class="fa fa-check"></i><b>2.2</b> Histograms</a></li>
<li class="chapter" data-level="2.3" data-path="r-eda.html"><a href="r-eda.html#summarising-data"><i class="fa fa-check"></i><b>2.3</b> Summarising data</a></li>
<li class="chapter" data-level="2.4" data-path="r-eda.html"><a href="r-eda.html#loops"><i class="fa fa-check"></i><b>2.4</b> Loops</a></li>
<li class="chapter" data-level="2.5" data-path="r-eda.html"><a href="r-eda.html#functions"><i class="fa fa-check"></i><b>2.5</b> Functions</a></li>
<li class="chapter" data-level="2.6" data-path="r-eda.html"><a href="r-eda.html#boxplots"><i class="fa fa-check"></i><b>2.6</b> Boxplots</a></li>
<li class="chapter" data-level="2.7" data-path="r-eda.html"><a href="r-eda.html#scatterplots"><i class="fa fa-check"></i><b>2.7</b> Scatterplots</a></li>
<li class="chapter" data-level="2.8" data-path="r-eda.html"><a href="r-eda.html#exercise-set-2-2"><i class="fa fa-check"></i><b>2.8</b> Exercise set 2-2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="best-fit-line.html"><a href="best-fit-line.html"><i class="fa fa-check"></i><b>3</b> Line of best fit</a><ul>
<li class="chapter" data-level="3.1" data-path="best-fit-line.html"><a href="best-fit-line.html#exercise-set-3-1"><i class="fa fa-check"></i><b>3.1</b> Exercise set 3-1</a></li>
<li class="chapter" data-level="3.2" data-path="best-fit-line.html"><a href="best-fit-line.html#exercise-set-3-2"><i class="fa fa-check"></i><b>3.2</b> Exercise set 3-2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability and random variables</a><ul>
<li class="chapter" data-level="4.0.1" data-path="probability.html"><a href="probability.html#probability-vs-estimation"><i class="fa fa-check"></i><b>4.0.1</b> Probability vs estimation</a></li>
<li class="chapter" data-level="4.0.2" data-path="probability.html"><a href="probability.html#what-is-a-probability"><i class="fa fa-check"></i><b>4.0.2</b> What is a probability?</a></li>
<li class="chapter" data-level="4.0.3" data-path="probability.html"><a href="probability.html#set-notation"><i class="fa fa-check"></i><b>4.0.3</b> Set notation</a></li>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#kolmogorovs-three-axioms-of-probability"><i class="fa fa-check"></i><b>4.1</b> Kolmogorov’s three axioms of probability</a><ul>
<li class="chapter" data-level="4.1.1" data-path="probability.html"><a href="probability.html#exercise-set-4-1"><i class="fa fa-check"></i><b>4.1.1</b> Exercise set 4-1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#conditional-probability-and-independence"><i class="fa fa-check"></i><b>4.2</b> Conditional probability and independence</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#exercise-set-4-2"><i class="fa fa-check"></i><b>4.2.1</b> Exercise set 4-2</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#bayes-theorem"><i class="fa fa-check"></i><b>4.3</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#discrete-random-variables-and-distributions"><i class="fa fa-check"></i><b>4.4</b> Discrete random variables and distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="probability.html"><a href="probability.html#exercise-set-4-3"><i class="fa fa-check"></i><b>4.4.1</b> Exercise set 4-3</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#continuous-random-variables-and-distributions"><i class="fa fa-check"></i><b>4.5</b> Continuous random variables and distributions</a><ul>
<li class="chapter" data-level="4.5.1" data-path="probability.html"><a href="probability.html#exercise-set-4-4"><i class="fa fa-check"></i><b>4.5.1</b> Exercise set 4-4</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="probability.html"><a href="probability.html#probability-density-functions"><i class="fa fa-check"></i><b>4.6</b> Probability density functions</a><ul>
<li class="chapter" data-level="4.6.1" data-path="probability.html"><a href="probability.html#additional-viz"><i class="fa fa-check"></i><b>4.6.1</b> Additional viz</a></li>
<li class="chapter" data-level="4.6.2" data-path="probability.html"><a href="probability.html#exercise-set-4-5"><i class="fa fa-check"></i><b>4.6.2</b> Exercise set 4-5</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="probability.html"><a href="probability.html#families-of-distributions"><i class="fa fa-check"></i><b>4.7</b> Families of distributions</a><ul>
<li class="chapter" data-level="4.7.1" data-path="probability.html"><a href="probability.html#exercise-set-4-6"><i class="fa fa-check"></i><b>4.7.1</b> Exercise set 4-6</a></li>
<li class="chapter" data-level="4.7.2" data-path="probability.html"><a href="probability.html#additional-exercise"><i class="fa fa-check"></i><b>4.7.2</b> Additional exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="randomvars.html"><a href="randomvars.html"><i class="fa fa-check"></i><b>5</b> Properties of random variables</a><ul>
<li class="chapter" data-level="5.1" data-path="randomvars.html"><a href="randomvars.html#expected-values-and-the-law-of-large-numbers"><i class="fa fa-check"></i><b>5.1</b> Expected values and the law of large numbers</a><ul>
<li class="chapter" data-level="5.1.1" data-path="randomvars.html"><a href="randomvars.html#weak-law-of-large-numbers"><i class="fa fa-check"></i><b>5.1.1</b> Weak law of large numbers</a></li>
<li class="chapter" data-level="5.1.2" data-path="randomvars.html"><a href="randomvars.html#handy-facts-about-expectations"><i class="fa fa-check"></i><b>5.1.2</b> Handy facts about expectations</a></li>
<li class="chapter" data-level="5.1.3" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-1"><i class="fa fa-check"></i><b>5.1.3</b> Exercise set 5-1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="randomvars.html"><a href="randomvars.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.2</b> Variance and standard deviation</a><ul>
<li class="chapter" data-level="5.2.1" data-path="randomvars.html"><a href="randomvars.html#beautiful-properties-of-the-variance"><i class="fa fa-check"></i><b>5.2.1</b> Beautiful properties of the variance</a></li>
<li class="chapter" data-level="5.2.2" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-2"><i class="fa fa-check"></i><b>5.2.2</b> Exercise set 5-2</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="randomvars.html"><a href="randomvars.html#joint-distributions-covariance-and-correlation"><i class="fa fa-check"></i><b>5.3</b> Joint distributions, covariance, and correlation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="randomvars.html"><a href="randomvars.html#joint-probability-distributions"><i class="fa fa-check"></i><b>5.3.1</b> Joint probability distributions</a></li>
<li class="chapter" data-level="5.3.2" data-path="randomvars.html"><a href="randomvars.html#marginal-distributions"><i class="fa fa-check"></i><b>5.3.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="5.3.3" data-path="randomvars.html"><a href="randomvars.html#covariance"><i class="fa fa-check"></i><b>5.3.3</b> Covariance</a></li>
<li class="chapter" data-level="5.3.4" data-path="randomvars.html"><a href="randomvars.html#correlation"><i class="fa fa-check"></i><b>5.3.4</b> Correlation</a></li>
<li class="chapter" data-level="5.3.5" data-path="randomvars.html"><a href="randomvars.html#additional-exercise-1"><i class="fa fa-check"></i><b>5.3.5</b> Additional exercise</a></li>
<li class="chapter" data-level="5.3.6" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-3"><i class="fa fa-check"></i><b>5.3.6</b> Exercise set 5-3</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="randomvars.html"><a href="randomvars.html#conditional-distribution-expectation-variance"><i class="fa fa-check"></i><b>5.4</b> Conditional distribution, expectation, variance</a></li>
<li class="chapter" data-level="5.5" data-path="randomvars.html"><a href="randomvars.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> The central limit theorem</a><ul>
<li class="chapter" data-level="5.5.1" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-4"><i class="fa fa-check"></i><b>5.5.1</b> Exercise set 5-4</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="randomvars.html"><a href="randomvars.html#a-probabilistic-model-for-simple-linear-regression"><i class="fa fa-check"></i><b>5.6</b> A probabilistic model for simple linear regression</a><ul>
<li class="chapter" data-level="5.6.1" data-path="randomvars.html"><a href="randomvars.html#assumptions-of-the-linear-model"><i class="fa fa-check"></i><b>5.6.1</b> Assumptions of the linear model</a></li>
<li class="chapter" data-level="5.6.2" data-path="randomvars.html"><a href="randomvars.html#important-claims-that-follow-from-these-assumptions"><i class="fa fa-check"></i><b>5.6.2</b> Important claims that follow from these assumptions</a></li>
<li class="chapter" data-level="5.6.3" data-path="randomvars.html"><a href="randomvars.html#checking-these-assumptions"><i class="fa fa-check"></i><b>5.6.3</b> Checking these assumptions</a></li>
<li class="chapter" data-level="5.6.4" data-path="randomvars.html"><a href="randomvars.html#exercise-set-5-5"><i class="fa fa-check"></i><b>5.6.4</b> Exercise set 5-5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimators.html"><a href="estimators.html"><i class="fa fa-check"></i><b>6</b> Properties of point estimators</a><ul>
<li class="chapter" data-level="6.1" data-path="estimators.html"><a href="estimators.html#bias"><i class="fa fa-check"></i><b>6.1</b> Bias</a><ul>
<li class="chapter" data-level="6.1.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-1"><i class="fa fa-check"></i><b>6.1.1</b> Exercise set 6-1</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="estimators.html"><a href="estimators.html#variance"><i class="fa fa-check"></i><b>6.2</b> Variance</a><ul>
<li class="chapter" data-level="6.2.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-2"><i class="fa fa-check"></i><b>6.2.1</b> Exercise set 6-2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="estimators.html"><a href="estimators.html#mean-squared-error"><i class="fa fa-check"></i><b>6.3</b> Mean squared error</a><ul>
<li class="chapter" data-level="6.3.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-3"><i class="fa fa-check"></i><b>6.3.1</b> Exercise set 6-3</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="estimators.html"><a href="estimators.html#consistency"><i class="fa fa-check"></i><b>6.4</b> Consistency</a><ul>
<li class="chapter" data-level="6.4.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-4"><i class="fa fa-check"></i><b>6.4.1</b> Exercise set 6-4</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="estimators.html"><a href="estimators.html#efficiency"><i class="fa fa-check"></i><b>6.5</b> Efficiency</a><ul>
<li class="chapter" data-level="6.5.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-5"><i class="fa fa-check"></i><b>6.5.1</b> Exercise set 6-5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="estimators.html"><a href="estimators.html#statistical-decision-theory-and-risk"><i class="fa fa-check"></i><b>6.6</b> Statistical decision theory and risk</a></li>
<li class="chapter" data-level="6.7" data-path="estimators.html"><a href="estimators.html#robustness"><i class="fa fa-check"></i><b>6.7</b> Robustness</a><ul>
<li class="chapter" data-level="6.7.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-8"><i class="fa fa-check"></i><b>6.7.1</b> Exercise set 6-8</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="estimators.html"><a href="estimators.html#estimators-for-simple-linear-regression"><i class="fa fa-check"></i><b>6.8</b> Estimators for simple linear regression</a><ul>
<li class="chapter" data-level="6.8.1" data-path="estimators.html"><a href="estimators.html#exercise-set-6-9"><i class="fa fa-check"></i><b>6.8.1</b> Exercise set 6-9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intervals.html"><a href="intervals.html"><i class="fa fa-check"></i><b>7</b> Interval estimation and inference</a><ul>
<li class="chapter" data-level="7.1" data-path="intervals.html"><a href="intervals.html#standard-error"><i class="fa fa-check"></i><b>7.1</b> Standard error</a><ul>
<li class="chapter" data-level="7.1.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-1"><i class="fa fa-check"></i><b>7.1.1</b> Exercise set 7-1</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intervals.html"><a href="intervals.html#confidence-intervals"><i class="fa fa-check"></i><b>7.2</b> Confidence intervals</a><ul>
<li class="chapter" data-level="7.2.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-2"><i class="fa fa-check"></i><b>7.2.1</b> Exercise set 7-2</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="intervals.html"><a href="intervals.html#frequentist-inference-i-null-hypotheses-test-statistics-and-p-values"><i class="fa fa-check"></i><b>7.3</b> Frequentist inference I: null hypotheses, test statistics, and <em>p</em> values</a><ul>
<li class="chapter" data-level="7.3.1" data-path="intervals.html"><a href="intervals.html#exercise-set-7-3"><i class="fa fa-check"></i><b>7.3.1</b> Exercise set 7-3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on Statistical Thinking from Scratch</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intervals" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Interval estimation and inference</h1>
<p>A single estimate is not enough, we need uncertainty. This chapter is about estimating intervals to go with our point estimates, and the related procedures of hypothesis testing (i.e., statistical inference).</p>
<div id="standard-error" class="section level2">
<h2><span class="header-section-number">7.1</span> Standard error</h2>
<p>The variance of an estimator, <span class="math inline">\(\text{Var}(\hat{\theta}_n)\)</span>, describes the spread of the estimator’s distribution. We define it in the same way that we defined the variance of a random variable:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Var}(\hat{\theta}_n) =&amp; ~ E[(\hat{\theta}_n(D) - E[\hat{\theta}_n(D)])^2] \\
=&amp; ~ E[(\hat{\theta}_n(D)^2] - (E[\hat{\theta}_n(D)])^2 \\
\end{aligned}
\]</span>
Compared to the expectation, or mean, of the estimator, the variance is in squared units. So we’d prefer to take the square root of the variance (<span class="math inline">\(\sigma^2\)</span>), otherwise known as the standard deviation (<span class="math inline">\(\sigma\)</span>). Rather than call the standard deviation of an estimator’s distribution the standard deviation, we call it the standard error instead:</p>
<p><span class="math display">\[
\begin{aligned}
\text{SE}(\hat{\theta}_n) =&amp; \sqrt{\text{Var}(\hat{\theta}_n)} \\
\end{aligned}
\]</span></p>
<p>This is confusing, but to paraphrase Edge:</p>
<blockquote>
<p>the term ‘standard error’ is used to describe the measure of spread of an <em>estimator’s</em> sampling distribution, whereas the term ‘standard deviation’ is reserved to describe the spread in distribution of the <em>data</em>.</p>
</blockquote>
<p>For example, when we describe a dataset using the mean, median, or mode - we are applying an estimator (a function) to the data to get a point estimate of the data. But in your introductory stats class, you probably did not refer to these functions as estimators - rather, they are often described as <em>summary statistics</em>. Then, to describe the uncertainty around the mean, we can calculate the standard error of the mean, which again, is just the standard deviation of the distribution of sample means. This distribution of sample means is known as a <em>sampling distribution</em>, but this term is not restricted to the mean - it applies to any estimator. Phew. Cogitate on this until it makes sense.</p>
<div id="exercise-set-7-1" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Exercise set 7-1</h3>
<ol style="list-style-type: decimal">
<li>See Edge solution or handwritten notes.</li>
</ol>
<ol start="4" style="list-style-type: lower-alpha">
<li>If we instead use the median, instead of the mean, as the estimator of <span class="math inline">\(\theta\)</span>, <span class="math inline">\(text{SE}(\hat{\theta}_n)\)</span> is 0.25 (higher than the standard erro of the mean for 25 samples, 0.2).</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># the value of mu does not affect the answer</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># (adding a constant to a random variable does not affect its variance)</span></a>
<a class="sourceLine" id="cb1-3" title="3">mu &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb1-4" title="4">stdev &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-5" title="5">n &lt;-<span class="st"> </span><span class="dv">25</span> </a>
<a class="sourceLine" id="cb1-6" title="6">n_sims &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">set.seed</span>(<span class="dv">101</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">s.mat &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> n, <span class="dt">nsim =</span> n_sims)</a>
<a class="sourceLine" id="cb1-9" title="9">ests.median &lt;-<span class="st"> </span><span class="kw">apply</span>(s.mat, <span class="dv">1</span>, median)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">sd</span>(ests.median)</a></code></pre></div>
<pre><code>## [1] 0.2478706</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Confirming the answer to part c:</span></a>
<a class="sourceLine" id="cb3-2" title="2">ests.mean &lt;-<span class="st"> </span><span class="kw">apply</span>(s.mat, <span class="dv">1</span>, mean)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">sd</span>(ests.mean)</a></code></pre></div>
<pre><code>## [1] 0.1984093</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>See Edge solution for a cogent explanation.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Under a normal distribution, the probability that the estimate (still a random variable) lies between plus and minus 1 SE of the mean is ~68% - we can use old-school look up tables or the <code>pnorm</code> function in R.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-2" title="2">w &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># this is the standard error of the mean</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co"># Pnorm gives the cumulative probability distribution, where q is the z-score</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># One tailed probabilities</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w)</a></code></pre></div>
<pre><code>## [1] 0.8413447</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">-1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w)</a></code></pre></div>
<pre><code>## [1] 0.1586553</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># To get the probability between the upper and lower w:</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">-1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w)</a></code></pre></div>
<pre><code>## [1] 0.6826895</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Under a normal distribution, the probability that the standard error lies between plus and minus 2 SE of the mean is ~95% - we can use old-school look up tables or the <code>pnorm</code> function in R.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb11-2" title="2">w &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co"># this is the standard error of the mean</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># Pnorm gives the cumulative probability distribution, where q is the z-score</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># One tailed probabilities</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w) <span class="co"># note that this value of q is twice w (the SE)</span></a></code></pre></div>
<pre><code>## [1] 0.9772499</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">-1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w)</a></code></pre></div>
<pre><code>## [1] 0.02275013</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># To get the probability between the upper and lower w:</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">-1</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> w)</a></code></pre></div>
<pre><code>## [1] 0.9544997</code></pre>
</div>
</div>
<div id="confidence-intervals" class="section level2">
<h2><span class="header-section-number">7.2</span> Confidence intervals</h2>
<p>Confidence interval for an estimand <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\text{P}(V_1 &lt; \theta &lt; V_2) \geq 1 - \alpha  \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(V_1\)</span> and <span class="math inline">\(V_2\)</span> are random variables that represent the upper and lower bounds of the interval, respectively. Therefore, the interval is also a random variable. But, the estimand (<span class="math inline">\(\theta\)</span>) is not - it is a fixed quantity. So in words, we can say that <span class="math inline">\(1 - \alpha\)</span> is the probability that the interval ranging from <span class="math inline">\(V_1\)</span> to <span class="math inline">\(V_2\)</span> covers <span class="math inline">\(\theta\)</span>; often called a <em>coverage probability</em>. Another way to write the equation is:</p>
<p><span class="math display">\[
\begin{aligned}
\text{P}(V_1 &lt; \theta \cap V_2 &gt; \theta) \geq 1 - \alpha  \\
\end{aligned}
\]</span></p>
<p>To refer to a confidence interval already calculated from data, we use (<span class="math inline">\(v_1, v_2\)</span>). In the plot below, I recreated Edge’s Figure 7-1. I took 20 samples from a standard normal distribution (mean = 0, sd = 1), and then calculated the sample mean, standard deviation, and standard error of the mean. One of the most commonly used 1 - <span class="math inline">\(\alpha\)</span> confidence intervals is:</p>
<p><span class="math display">\[
\begin{aligned}
(\hat{\theta} - \omega z_{\alpha / 2}, \hat{\theta} + \omega z_{\alpha / 2}) \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\omega\)</span> is the standard error, and <span class="math inline">\(z_{\alpha / 2}\)</span> represents the z-score, or the number of standard deviations for a standard normal distribution (i.e., a standardized distribution). The product of these two values represents the amount we add to the point estimate (i.e., the mean) to get the upper bound, and subtract from the point estimate to get the lower bound.</p>
<p>To get the desired z-score, we have to work backwards from our desired <span class="math inline">\(\alpha\)</span> level. Here, we are using 0.1, so we take the inverse of the cumulative distribution function in R using <code>qnorm</code> - or you could do this using look-up tables. Either way, the z-score that returns a 90% probability is ~1.64 for a standard normal distribution. Here’s the equation:</p>
<p><span class="math display">\[
\begin{aligned}
z_{\alpha / 2} =&amp; \phi^{-1} (1 - \alpha / 2) \\
\phi^{-1} =&amp; ~\text{inverse of the cumulative distribution function of a Normal(0,1) distribution}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb17-2" title="2">stdev &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb17-4" title="4">n_sims &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">set.seed</span>(<span class="dv">99</span>)</a>
<a class="sourceLine" id="cb17-6" title="6">s.mat &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> n, <span class="dt">nsim =</span> n_sims)</a>
<a class="sourceLine" id="cb17-7" title="7">ests_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(s.mat, <span class="dv">1</span>, mean)</a>
<a class="sourceLine" id="cb17-8" title="8">ests_sd &lt;-<span class="st"> </span><span class="kw">apply</span>(s.mat, <span class="dv">1</span>, sd)</a>
<a class="sourceLine" id="cb17-9" title="9"></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co"># 90% confidence intervals</span></a>
<a class="sourceLine" id="cb17-11" title="11">my_z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>, mu, stdev)</a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sim =</span> <span class="dv">1</span><span class="op">:</span>n_sims, </a>
<a class="sourceLine" id="cb17-14" title="14">            <span class="dt">mean =</span> ests_mean, </a>
<a class="sourceLine" id="cb17-15" title="15">            <span class="dt">sd =</span> ests_sd, </a>
<a class="sourceLine" id="cb17-16" title="16">            <span class="dt">se =</span> ests_sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n), </a>
<a class="sourceLine" id="cb17-17" title="17">            <span class="dt">upper =</span> mean <span class="op">+</span><span class="st"> </span>se<span class="op">*</span>my_z, </a>
<a class="sourceLine" id="cb17-18" title="18">            <span class="dt">lower =</span> mean <span class="op">-</span><span class="st"> </span>se<span class="op">*</span>my_z, </a>
<a class="sourceLine" id="cb17-19" title="19">            <span class="dt">sig =</span> <span class="kw">ifelse</span>(upper <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>lower <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;different&quot;</span>, </a>
<a class="sourceLine" id="cb17-20" title="20">                         <span class="st">&quot;not different&quot;</span>))</a>
<a class="sourceLine" id="cb17-21" title="21"></a>
<a class="sourceLine" id="cb17-22" title="22">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sim, <span class="dt">y =</span> mean, <span class="dt">color =</span> sig)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-27" title="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Confidence interval for &quot;</span>, theta, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)), </a>
<a class="sourceLine" id="cb17-28" title="28">       <span class="dt">x =</span> <span class="st">&quot;Simulation number&quot;</span>, </a>
<a class="sourceLine" id="cb17-29" title="29">       <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;True &quot;</span>, theta, <span class="st">&quot; is 0&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In this set of simulations, the confidence intervals estimated from 46 of 50 (92%) of the simulations overlapped with the true value of <span class="math inline">\(\theta\)</span>, 0.</p>
<p>I am still struggling with how to articulate the meaning of an already calculated confidence interval that is consistent with the frequentist philosophy. Even after reading the explanation in Edge (and many other explanations) I do not, in my core, feel that I understand it. So you’re not alone if you don’t quite get it. But if you do, please, let’s chat!</p>
<div id="exercise-set-7-2" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Exercise set 7-2</h3>
<ol style="list-style-type: decimal">
<li>50% confidence interval; upper = 4, lower = 2.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>What is <span class="math inline">\(z_{\alpha / 2}\)</span> for <span class="math inline">\(\alpha = 0.5\)</span>?</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">my_alpha &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb18-2" title="2">my_p &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>my_alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb18-3" title="3">my_z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> my_p, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">my_z</a></code></pre></div>
<pre><code>## [1] 0.6744898</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># Plot a standard normal distribution</span></a>
<a class="sourceLine" id="cb20-2" title="2">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dt">length.out =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb20-3" title="3">fx &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x)</a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">plot</span>(x, fx, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co"># Shade in the appropriate area</span></a>
<a class="sourceLine" id="cb20-7" title="7">x.zs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span>my_z, my_z, <span class="dt">length.out =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb20-8" title="8">fx.zs &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x.zs)</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">polygon</span>(<span class="kw">c</span>(<span class="op">-</span>my_z, x.zs, my_z), <span class="kw">c</span>(<span class="dv">0</span>, fx.zs, <span class="dv">0</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The area of the shaded region is 0.5.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>In equation 7.3, the point estimate is halfway between the upper and lower bounds, and thus is 3.</p></li>
<li><p>The standard error is 1 / 0.674 = 1.48.</p></li>
<li><p>95% CI is roughly (0, 6).</p></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">my_se &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>my_z</a>
<a class="sourceLine" id="cb21-2" title="2">z_<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">int_<span class="dv">95</span> &lt;-<span class="st"> </span>my_se <span class="op">*</span><span class="st"> </span>z_<span class="dv">95</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="dv">3</span> <span class="op">+</span><span class="st"> </span>int_<span class="dv">95</span>; <span class="dv">3</span> <span class="op">-</span><span class="st"> </span>int_<span class="dv">95</span></a></code></pre></div>
<pre><code>## [1] 5.905847</code></pre>
<pre><code>## [1] 0.09415305</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>How many SE’s from 0 is <span class="math inline">\(\theta\)</span>?</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="dv">3</span> <span class="op">/</span><span class="st"> </span>my_se</a></code></pre></div>
<pre><code>## [1] 2.023469</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>We want the lower bound to sit on zero - this means the value that we subtract from our estimand is 3. The value that we subtract is the product of the SE and z-score. We know the SE - it is 1.48. So we calculate 3 / 1.48 = 2.03. This value represents the z-score for <span class="math inline">\(z_{\alpha / 2}\)</span>. But what is <span class="math inline">\(\alpha\)</span>, the probability level we need to be 2.03 SDs below the mean? This is where <code>pnorm</code> comes in:</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="fl">2.03</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.04235654</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Assume <span class="math inline">\(\theta\)</span> = 0. What is the probability of obtaining an estimate such that it is larger than the estimate considered in this example? To get a value of 3, if the true estimate is 0, we’d need a z-score of 2.03 again. This equates to a probability of 0.043 to retrieve something greater than 3, or less than -3.</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb28-2" title="2">test_value &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb28-3" title="3">my_z &lt;-<span class="st"> </span>test_value <span class="op">/</span><span class="st"> </span>my_se  </a>
<a class="sourceLine" id="cb28-4" title="4">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> my_z)) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.04302479</code></pre>
</div>
</div>
<div id="frequentist-inference-i-null-hypotheses-test-statistics-and-p-values" class="section level2">
<h2><span class="header-section-number">7.3</span> Frequentist inference I: null hypotheses, test statistics, and <em>p</em> values</h2>
<p>Null hypothesis</p>
<p>Test statistic</p>
<p>Hypothesis test</p>
<div id="exercise-set-7-3" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Exercise set 7-3</h3>
<ol style="list-style-type: decimal">
<li>Three reasons why the outcome of the hypothesis test is indecisive about the truth of the theory (that smaller people will be attracted to hotter climates because smaller bodies shed heat more efficiently):</li>
</ol>
<ul>
<li><p>Arizona may not be representative of hotter climates (i.e., need different geographic locations)</p></li>
<li><p>women may be different from men, and thus the result does not apply to people generally</p></li>
<li><p>the test does not let us say anything about the mechanism (heat shedding), but only the pattern (size variation)</p></li>
<li><p>see Edge for a general explanation that touches on some of the above</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Average nail length is 100 mm. SD is 2 mm. I measure 4 nails.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>SE = sd / sqrt(n); SE = 2 / sqrt(4) = 1</li>
<li>1.96 * SE; 95% CI for <span class="math inline">\(\mu\)</span> is (98, 102)</li>
<li>Anything less than 98 or more than 102, following from previous answer. Or, more precisely:</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># left tail</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">qnorm</span>(<span class="fl">0.025</span>, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 98.04004</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># right tail</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 101.96</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Simulating data assuming the null hypothesis is true.</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">twotailed.p.normal &lt;-<span class="st"> </span><span class="cf">function</span>(x.bar, mu, stand.err){</a>
<a class="sourceLine" id="cb34-2" title="2">  abs.diff &lt;-<span class="st"> </span><span class="kw">abs</span>(x.bar <span class="op">-</span><span class="st"> </span>mu)</a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(mu <span class="op">-</span><span class="st"> </span>abs.diff, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> stand.err)</a>
<a class="sourceLine" id="cb34-4" title="4">}</a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb34-7" title="7">x &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">nsim =</span> n, <span class="dt">rx =</span> rnorm, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-8" title="8">x_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb34-9" title="9">x_p &lt;-<span class="st"> </span><span class="kw">sapply</span>(x_mean, <span class="dt">FUN =</span> twotailed.p.normal, <span class="dt">mu =</span> <span class="dv">100</span>, <span class="dt">stand.err =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-10" title="10"><span class="kw">hist</span>(x_p)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Values less than 0.05</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.0516</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">mean</span>(x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a></code></pre></div>
<pre><code>## [1] 0.0516</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># Values less than 0.1</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.0988</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>Simulating data assuming the null hypothesis is false (mean = 101):</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">twotailed.p.normal &lt;-<span class="st"> </span><span class="cf">function</span>(x.bar, mu, stand.err){</a>
<a class="sourceLine" id="cb41-2" title="2">  abs.diff &lt;-<span class="st"> </span><span class="kw">abs</span>(x.bar <span class="op">-</span><span class="st"> </span>mu)</a>
<a class="sourceLine" id="cb41-3" title="3">  <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(mu <span class="op">-</span><span class="st"> </span>abs.diff, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> stand.err)</a>
<a class="sourceLine" id="cb41-4" title="4">}</a>
<a class="sourceLine" id="cb41-5" title="5"></a>
<a class="sourceLine" id="cb41-6" title="6">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb41-7" title="7">x &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">nsim =</span> n, <span class="dt">rx =</span> rnorm, <span class="dt">mean =</span> <span class="dv">101</span>, <span class="dt">sd =</span> <span class="dv">2</span>) <span class="co"># CHANGED</span></a>
<a class="sourceLine" id="cb41-8" title="8">x_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb41-9" title="9">x_p &lt;-<span class="st"> </span><span class="kw">sapply</span>(x_mean, <span class="dt">FUN =</span> twotailed.p.normal, <span class="dt">mu =</span> <span class="dv">100</span>, <span class="dt">stand.err =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-10" title="10"><span class="kw">hist</span>(x_p)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># Values less than 0.05</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.166</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">mean</span>(x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="co"># same result!</span></a></code></pre></div>
<pre><code>## [1] 0.166</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co"># Values less than 0.1</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.2596</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>Simulating data assuming the null hypothesis is false (mean = 102).</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">twotailed.p.normal &lt;-<span class="st"> </span><span class="cf">function</span>(x.bar, mu, stand.err){</a>
<a class="sourceLine" id="cb48-2" title="2">  abs.diff &lt;-<span class="st"> </span><span class="kw">abs</span>(x.bar <span class="op">-</span><span class="st"> </span>mu)</a>
<a class="sourceLine" id="cb48-3" title="3">  <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(mu <span class="op">-</span><span class="st"> </span>abs.diff, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> stand.err)</a>
<a class="sourceLine" id="cb48-4" title="4">}</a>
<a class="sourceLine" id="cb48-5" title="5"></a>
<a class="sourceLine" id="cb48-6" title="6">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb48-7" title="7">x &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">nsim =</span> n, <span class="dt">rx =</span> rnorm, <span class="dt">mean =</span> <span class="dv">102</span>, <span class="dt">sd =</span> <span class="dv">2</span>) <span class="co"># CHANGED</span></a>
<a class="sourceLine" id="cb48-8" title="8">x_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb48-9" title="9">x_p &lt;-<span class="st"> </span><span class="kw">sapply</span>(x_mean, <span class="dt">FUN =</span> twotailed.p.normal, <span class="dt">mu =</span> <span class="dv">100</span>, <span class="dt">stand.err =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-10" title="10"><span class="kw">hist</span>(x_p)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># Values less than 0.05</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.5088</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># Values less than 0.1</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.6352</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Simulating data assuming the null hypothesis is false (mean = 101, n = 16). This means the standard error is now 2 / sqrt(16) = 0.5</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">twotailed.p.normal &lt;-<span class="st"> </span><span class="cf">function</span>(x.bar, mu, stand.err){</a>
<a class="sourceLine" id="cb53-2" title="2">  abs.diff &lt;-<span class="st"> </span><span class="kw">abs</span>(x.bar <span class="op">-</span><span class="st"> </span>mu)</a>
<a class="sourceLine" id="cb53-3" title="3">  <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(mu <span class="op">-</span><span class="st"> </span>abs.diff, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> stand.err)</a>
<a class="sourceLine" id="cb53-4" title="4">}</a>
<a class="sourceLine" id="cb53-5" title="5"></a>
<a class="sourceLine" id="cb53-6" title="6">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb53-7" title="7">x &lt;-<span class="st"> </span><span class="kw">mat.samps</span>(<span class="dt">n =</span> <span class="dv">16</span>, <span class="dt">nsim =</span> n, <span class="dt">rx =</span> rnorm, <span class="dt">mean =</span> <span class="dv">101</span>, <span class="dt">sd =</span> <span class="dv">2</span>) <span class="co"># CHANGED</span></a>
<a class="sourceLine" id="cb53-8" title="8">x_mean &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb53-9" title="9">x_p &lt;-<span class="st"> </span><span class="kw">sapply</span>(x_mean, <span class="dt">FUN =</span> twotailed.p.normal, <span class="dt">mu =</span> <span class="dv">100</span>, <span class="dt">stand.err =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb53-10" title="10"><span class="kw">hist</span>(x_p)</a></code></pre></div>
<p><img src="07_interval-estimation_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># Values less than 0.05</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.5109</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># Values less than 0.1</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">length</span>(x_p[x_p <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>]) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<pre><code>## [1] 0.6351</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimators.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
